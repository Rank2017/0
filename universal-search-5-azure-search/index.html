<!DOCTYPE html><html><head><meta charset="utf-8"><title>Universal Search #5 Azure Search | Artifact.</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="This is the 5th article in a series that covers the steps to add searching to Ghost, Hexo or any general website using APIs provided by various services.The latest version of Universal Search is avail"><meta name="keywords" content="Ghost,Hexo,Search,API"><meta property="og:type" content="article"><meta property="og:title" content="Universal Search #5 Azure Search"><meta property="og:url" content="http://artifact.me/universal-search-5-azure-search/index.html"><meta property="og:site_name" content="Artifact."><meta property="og:description" content="This is the 5th article in a series that covers the steps to add searching to Ghost, Hexo or any general website using APIs provided by various services.The latest version of Universal Search is avail"><meta property="og:image" content="https://cdn.otakism.com/images/universal-search/azure/azure-01.png"><meta property="og:image" content="https://cdn.otakism.com/images/universal-search/azure/azure-02.png"><meta property="og:image" content="https://cdn.otakism.com/images/universal-search/azure/azure-03.png"><meta property="og:image" content="https://cdn.otakism.com/images/universal-search/azure/azure-04.png"><meta property="og:image" content="https://cdn.otakism.com/images/universal-search/azure/azure-05.png"><meta property="og:updated_time" content="2017-03-28T07:20:49.192Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Universal Search #5 Azure Search"><meta name="twitter:description" content="This is the 5th article in a series that covers the steps to add searching to Ghost, Hexo or any general website using APIs provided by various services.The latest version of Universal Search is avail"><meta name="twitter:image" content="https://cdn.otakism.com/images/universal-search/azure/azure-01.png"><link rel="icon" href="/favicon.png"><script src="https://use.typekit.net/eyf3hir.js"></script><script>try{Typekit.load({async:!1})}catch(a){}</script><link rel="stylesheet" href="/icomoon/style.css"><link rel="stylesheet" href="/style.css"></head></html><body><div class="site-wrapper"><div id="loading-bar-wrapper"><div id="loading-bar"></div></div><script>document.getElementById("loading-bar").style.width="20%"</script><header id="header" class="site-header clearfix"><a class="logo square clearfix" href="/"><span class="b">A</span> <span class="b">R</span> <span class="b">T</span> <span class="w">I</span> <span class="w">F</span> <span class="b">A</span> <span class="b">C</span> <span class="b">T</span> </a><a class="me square site-nav-switch clearfix"><span class="b"><span class="icon icon-menu"></span></span></a></header><script>document.getElementById("loading-bar").style.width="40%"</script><main id="main" class="clearfix"><article id="post-universal-search-5-azure-search" class="article white-box article-type-post" itemscope itemprop="blogPost"><header class="article-header"><h1 class="article-title" itemprop="name">Universal Search #5 Azure Search</h1><div class="article-meta">Posted on <time class="article-time" datetime="2016-09-03T22:30:34.000Z" itemprop="datePublished">Sep 3, 2016</time></div></header><div class="article-entry" itemprop="articleBody"><p>This is the 5th article in a series that covers the steps to add searching to <a href="http://ghost.org" target="_blank" rel="external">Ghost</a>, <a href="http://hexo.io" target="_blank" rel="external">Hexo</a> or any general website using APIs provided by various services.</p><p>The latest version of Universal Search is available on Github at <a href="https://github.com/artchen/universal-search" target="_blank" rel="external">https://github.com/artchen/universal-search</a>.</p><p>We have covered UI and common logics in <a href="/universal-search-1-common-logic/">the first article</a>. In this article we are going to explore <a href="https://azure.microsoft.com/en-us/services/search/" target="_blank" rel="external">Azure Search</a>.</p><h2 id="register-for-service"><a href="#Register-for-Service" class="headerlink" title="Register for Service"></a>Register for Service</h2><p>First of all, register an Azure account or just use your Microsoft account (outlook.com, hotmail.com, etc), and start your free trial.</p><p>Go to the dashboard, and create a new service.</p><p><a href="https://cdn.otakism.com/images/universal-search/azure/azure-01.png" target="_blank" rel="external"><img src="https://cdn.otakism.com/images/universal-search/azure/azure-01.png" alt="Azure-01"></a></p><p>Search “Azure Search”.</p><p><a href="https://cdn.otakism.com/images/universal-search/azure/azure-02.png" target="_blank" rel="external"><img src="https://cdn.otakism.com/images/universal-search/azure/azure-02.png" alt="Azure-02"></a></p><p>Create a free Azure Search service. The creation might take a few minutes.</p><p><a href="https://cdn.otakism.com/images/universal-search/azure/azure-03.png" target="_blank" rel="external"><img src="https://cdn.otakism.com/images/universal-search/azure/azure-03.png" alt="Azure-03"></a></p><p>Go to the control panel of your new Azure Search service. Choose Keys to reveal admin keys. Note down your primary admin key. We need this admin key to access the REST API.</p><p><a href="https://cdn.otakism.com/images/universal-search/azure/azure-04.png" target="_blank" rel="external"><img src="https://cdn.otakism.com/images/universal-search/azure/azure-04.png" alt="Azure-04"></a></p><p>On the same panel, select “Manage query keys” and create a new query key. Note it down again. This query key will be used on the front-end to query your created index.</p><p><a href="https://cdn.otakism.com/images/universal-search/azure/azure-05.png" target="_blank" rel="external"><img src="https://cdn.otakism.com/images/universal-search/azure/azure-05.png" alt="Azure-05"></a></p><h2 id="generate-and-upload-data"><a href="#Generate-and-upload-data" class="headerlink" title="Generate and upload data"></a>Generate and upload data</h2><p>Just like <a href="https://www.algolia.com/" target="_blank" rel="external">Algolia</a>, Azure Search does not index your website automatically. Instead, it requires the users to create indexes and upload data.</p><p>In this tutorial, I will use <a href="https://github.com/artchen/hexo-azuresearch" target="_blank" rel="external">hexo-azuresearch</a>, a plugin that I wrote, to demonstrate how to integrate Azure Search with Hexo. If your website is on other platforms, Azure provides detailed documentation about all the APIs it supports so it should not be too complicated to write your own indexer and data uploader.</p><p>A heads up notice for non-English users, at this point I cannot get Azure Search to work with other languages. I will look into this issue.</p><h3 id="hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h3><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">npm install --save hexo-azuresearch</div></pre></td></tr></table></figure><p>In your global <code>_config.yml</code>, add the following configuration:</p><p>In order for our front-end to work, you must include <code>title</code>, <code>excerpt:strip</code> and <code>path</code>. The other fields only help with searching accuracy.</p><figure class="highlight yml"><table><tr><td class="code"><pre><div class="line"><span class="comment"># Azure Search</span></div><div class="line"><span class="attr">AzureSearch:</span></div><div class="line"><span class="attr">  serviceURL:</span> <span class="string">"https://&lt;your-service-name&gt;.search.windows.net"</span></div><div class="line"><span class="attr">  indexName:</span> <span class="string">"&lt;your-index-name&gt;"</span></div><div class="line"><span class="attr">  adminKey:</span> <span class="string">"&lt;your-azure-search-admin-key&gt;"</span></div><div class="line"><span class="attr">  analyzer:</span> <span class="string">"zh-Hans.lucene"</span> <span class="comment"># optional</span></div><div class="line"><span class="attr">  fields:</span></div><div class="line"><span class="bullet">    -</span> <span class="string">title</span></div><div class="line"><span class="attr">    - excerpt:</span><span class="string">strip</span></div><div class="line"><span class="attr">    - content:</span><span class="string">strip</span></div><div class="line"><span class="bullet">    -</span> <span class="string">path</span></div><div class="line"><span class="bullet">    -</span> <span class="string">permalink</span></div></pre></td></tr></table></figure><p>Then run the following command to index and upload data:</p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">hexo azuresearch</div></pre></td></tr></table></figure><h3 id="ghost"><a href="#Ghost" class="headerlink" title="Ghost"></a>Ghost</h3><p>Unfortunately there is no existing support for Ghost.</p><h2 id="build-the-class"><a href="#Build-the-class" class="headerlink" title="Build the class"></a>Build the class</h2><p>This section is more of a development note. Plugin users don’t have to read it.</p><p>The class for Azure Search is very similar to the one we built for <a href="/universal-search-2-google-custom-search-engine/">Google Custom Search Engine</a>. The only differences are the credentials and data formats.</p><script src="https://gist.github.com/artchen/a480bf1e066ca7412a2f20c40961782d.js"></script><h2 id="enable-your-search"><a href="#Enable-your-search" class="headerlink" title="Enable your search"></a>Enable your search</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> customSearch = <span class="keyword">new</span> AzureSearch(&#123;</div><div class="line">  serviceName: AZURE_SERVICE_NAME,</div><div class="line">  indexName: AZURE_INDEX_NAME,</div><div class="line">  queryKey: AZURE_QUERY_KEY</div><div class="line">&#125;);</div></pre></td></tr></table></figure></div><div class="article-tags"><a class="tag-link" href="/tags/api/">API</a><a class="tag-link" href="/tags/ghost/">Ghost</a><a class="tag-link" href="/tags/hexo/">Hexo</a><a class="tag-link" href="/tags/search/">Search</a></div><section id="comments" class="white-box"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></article><script>document.getElementById("loading-bar").style.width="60%"</script></main><footer id="footer" class="clearfix"><div class="search"><form name="searchform" id="searchform" class="u-search-form"><input type="text" id="searchinput" class="u-search-input st-default-search-input" data-list-highlight="true" data-list-value-completion="true" placeholder="Looking for something?"> <button type="submit" id="u-search-btn-submit" class="u-search-btn-submit"><span class="icon icon-search"></span></button></form></div><div>&copy; <a href="http://artifact.me">Artifact.</a> Theme by <a href="http://artifact.me/" target="_blank">Art Chen</a>.</div><div>Powered by <a href="https://hexo.io/" rel="external">Hexo</a>.</div></footer><script>document.getElementById("loading-bar").style.width="80%"</script><div class="overlay"></div></div><div class="site-sidebar"><div class="sidebar-switch clearfix show" style="display:block"><a class="dark-btn active" data-toggle="toc"><span class="icon icon-list"></span> <span class="text">Index</span> </a><a class="dark-btn" data-toggle="bio"><span class="icon icon-person"></span> <span class="text">Bio</span></a></div><div class="site-toc show" style="display:block"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#register-for-service"><span class="toc-number">1.</span> <span class="toc-text">Register for Service</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#generate-and-upload-data"><span class="toc-number">2.</span> <span class="toc-text">Generate and upload data</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hexo"><span class="toc-number">2.1.</span> <span class="toc-text">Hexo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ghost"><span class="toc-number">2.2.</span> <span class="toc-text">Ghost</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#build-the-class"><span class="toc-number">3.</span> <span class="toc-text">Build the class</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#enable-your-search"><span class="toc-number">4.</span> <span class="toc-text">Enable your search</span></a></li></ol></div><div class="site-bio" style="display:none"><div class="about-me clearfix"><div class="avatar"><img src="/img/avatar.png"></div><div class="info"><a class="name dark-btn" href="/about">Art Chen</a></div><div class="info"><span class="item desc">A frog jumps into the pond, splash! Silence again.</span></div></div><div class="social clearfix"><a href="/atom.xml" class="feed" target="_blank" rel="external"><span class="icon icon-feed"></span> </a><a href="https://github.com/artchen" class="github" target="_blank" rel="external"><span class="icon icon-github"></span> </a><a href="https://twitter.com/otakism" class="twitter" target="_blank" rel="external"><span class="icon icon-twitter"></span> </a><a href="https://plus.google.com/+ArtChenOtakism/posts" class="google" target="_blank" rel="external"><span class="icon icon-google"></span></a></div><div class="shortcuts clearfix"><div class="bk"><a href="#header" class="dark-btn window-nav"><span class="icon icon-chevron-thin-up"></span> <span class="text">Back to Top</span></a></div><div class="bk"><a href="#footer" class="dark-btn window-nav"><span class="icon icon-chevron-thin-down"></span> <span class="text">Go to Bottom</span></a></div></div></div></div><script type="text/javascript">var GOOGLE_CUSTOM_SEARCH_API_KEY="AIzaSyBFj4A2FRz36n1bLiOQbcGhmUdpM-buAZ0",GOOGLE_CUSTOM_SEARCH_ENGINE_ID="017821029378163458527:c46kp7iwut4",ALGOLIA_API_KEY="008d881e77dc9e73065e4635140fce5c",ALGOLIA_APP_ID="PAM0DKEGE7",ALGOLIA_INDEX_NAME="artifact.me",AZURE_SERVICE_NAME="otakism",AZURE_INDEX_NAME="artifact",AZURE_QUERY_KEY="C1398F1CAD22087764DB51A21E4C2FDE",BAIDU_API_ID="8200259220702189810",SEARCH_SERVICE="swiftype"</script><script src="https://code.jquery.com/jquery-2.1.4.min.js"></script><script>window.jQuery||document.write('<script src="/js/jquery.js"><\/script>')</script><script src="/js/search.js"></script><script src="/js/app.js"></script><script type="text/javascript">var disqus_shortname="artchen",disqus_url="http://artifact.me/universal-search-5-azure-search/";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><script type="text/javascript">!function(t,e,s,n,c,i,a){t.SwiftypeObject=c,t[c]=t[c]||function(){(t[c].q=t[c].q||[]).push(arguments)},i=e.createElement(s),a=e.getElementsByTagName(s)[0],i.async=1,i.src="//s.swiftypecdn.com/install/v2/st.js",a.parentNode.insertBefore(i,a)}(window,document,"script",0,"_st"),_st("install","FHMeAyBdVccJECstf-XJ","2.0.0")</script><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-569722b77263e377" async></script><script>document.getElementById("loading-bar").style.width="100%"</script></body>